<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>The Ale Tavern</title>

        <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <style>
         body { padding-top:50px; }
        </style>

    </head>

    <body>
      <div id="root">not rendered
        <div class="container">
            <div class="jumbotron text-center">
                <h1>Future of Ale Tavern</h1>
		            <h3>A place to play games with friends, in person.</h3>
            </div>
        </div>

        <div class="container">
            <div class="jumbotron text-center">
                <h4 id="rMessage"></h4>

                <input id="sMessage" type="text" autocomplete="off">
                <input id="sendMessageToAll"type="button" name="submit" value="sendMessageToAll()" onclick="sendMessageToAll();" />
                <input id="sendMessageToHost"type="button" name="submit" value="sendMessageToHost()" onclick="sendMessageToHost();" />
                <input id="joinGame"type="button" name="submit" value="joinGame()" onclick="joinGame();" />
                <input id="createGame"type="button" name="submit" value="createGame()" onclick="createGame();" />
                <input id="reconnectGame"type="button" name="submit" value="reconnectGame()" onclick="reconnectGame();" />
                <input id="leaveGame"type="button" name="submit" value="leaveGame()" onclick="leaveGame();" />
            </div>
        </div>

        <div class="container">
            <ul id ="messages"></ul>
        </div>
      </div>

        <script src="https://unpkg.com/react@16.8.4/umd/react.development.js"></script>
        <script src="https://unpkg.com/react-dom@16.8.4/umd/react-dom.development.js"></script>
        <script src="GameWebSocket.js"></script>

        <script>
          const App = () => { return React.createElement("div", {}, React.createElement("h1", {}, "Adopt Me!"))};

          ReactDOM.render(React.createElement(App), document.getElementById("root"));


          /*******************************************************/

         var input = document.getElementById("sMessage");
         var output = document.getElementById("messages");

         var gameWebSocket = new GameWebSocket(true);


         // ***************** Event listeners **********************************
         // Pressing enter will default to "sendMessage()"
         input.addEventListener("keydown", function(event){
             if (event.keyCode === 13)
             {
                 event.preventDefault();
                 document.getElementById("sendMessageToAll").click();
             }
         });

         // Listen for messages


         // ********************* BUTTON FUNCTIONS *******************************

         function createGame(){
             gameWebSocket.createGame("The_gameType");
         }

         function joinGame(){
             gameWebSocket.joinGame(getAndClearInput());
         }

         function sendMessageToAll(msg){
             gameWebSocket.sendMessageToAll(getAndClearInput());
         }

         function sendMessageToHost(msg){
             gameWebSocket.sendMessageToHost(getAndClearInput());
         }

         function reconnectGame(){
             gameWebSocket.reconnectGame();
         }

         function leaveGame(){
             gameWebSocket.leaveGame();
         }

         // *********************** ON EVENT FUNCTIONS *************************

         gameWebSocket.onCreateGame = (msg) => {let text = "Game created with ID: " + msg.data; addToChat(text)};
         gameWebSocket.onMessageGame = (msg) => { addToChat(msg.playerId + " sent: " + msg.data)};
         gameWebSocket.onOtherJoinGame = (msg) => { addToChat(msg.playerId + " joined the game.")};
         gameWebSocket.onOtherLeaveGame = (msg) => { addToChat(msg.playerId + " left the game.")};


         // ******************* HELPER FUNCTIONS *******************************
         function getAndClearInput(){
             var val = input.value;
             input.value = "";
             return val;
         }

         function addToChat(text)
         {
             let entry = document.createElement("LI");
             entry.innerHTML = text;
             output.insertBefore(entry, output.firstChild);
         }

        </script>

    </body>
</html>

